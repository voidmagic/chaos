import collections

import numpy as np
from matplotlib import pyplot as plt
from scipy.cluster.hierarchy import dendrogram, linkage, cut_tree

m2o = """
ar	bg	cs	de	el	es	fa	fr	he	hr	hu	id	it	ja	ko	nl	pl	pt	ro	ru	sk	sr	sv	th	tr	uk	vi	zh
0.20646441	0.02316099	-0.02036184	-0.0171051	0.03216499	-0.01012987	0.02482933	0.01138216	0.0585174	0.00040823	-0.02135623	0.01010966	0.01260799	-0.0327509	-0.06015813	-0.04524893	-0.02156472	0.00617164	0.02193201	0.01257563	-0.02937454	-0.01872808	0.01256263	-0.01302665	-0.00601262	0.04102242	0.02085769	0.03112543
0.02577937	0.11292511	-0.01103193	-0.0292806	0.04870933	0.04853314	-0.01033616	0.0277912	0.0156123	-0.0025388	0.02683336	0.01034147	0.01056415	-0.04458696	-0.00808269	-0.00710756	-0.04239315	0.01169151	-0.0174436	0.00073051	0.03778601	0.0023315	-0.01131052	-0.02683294	-0.0124054	0.02179158	0.00750422	-0.02194738
0.00186878	0.00720614	0.06994474	0.00048685	-0.02892858	-0.0021407	0.00029576	0.02008927	-0.00425225	0.01588804	0.00309384	0.01340699	0.01494485	0.00146568	-0.02930588	-0.00753403	0.02120882	0.00742501	0.01935351	0.02740777	0.09978616	-0.01111764	0.05273211	-0.01911592	0.00587428	0.00412053	0.00189835	0.02669322
-0.01661634	-0.0158487	0.02126282	0.08236706	-0.00092328	0.00279838	-0.02009273	0.02280295	-0.00682312	0.02511841	0.03578895	0.02440935	0.04039288	0.01685882	0.00336277	0.04413927	0.04366118	0.0121724	-0.04636556	0.05358917	-0.01505679	0.0038867	-0.00703931	-0.03966534	0.01614815	0.03851032	0.0000174	0.01379591
0.03369558	-0.00601214	0.00391972	-0.0158425	0.06097358	0.00582838	0.02737838	0.0005548	0.03175336	-0.02046508	-0.01136565	-0.05792278	0.00876045	-0.04112995	0.02510905	-0.01275122	0.0150454	0.01114494	0.01423168	0.05024421	0.04480582	-0.00393063	0.02715772	0.00297761	-0.00489533	0.01158392	0.01252097	0.00092101
-0.00798553	-0.01923186	0.01247424	-0.01711738	0.01438183	0.12313014	-0.02648854	0.02586442	0.00410193	0.00377268	0.0377937	0.04319805	0.0459826	-0.02662855	-0.08566099	0.02753693	0.0234468	0.0814352	0.07051009	0.01036209	-0.00425744	0.02958196	0.00462466	-0.03871971	0.0374428	0.00686324	0.00949043	0.00613815
0.05766678	-0.01163518	0.00000495	-0.02748674	0.00794476	-0.02138692	0.10260314	0.0134654	0.05603707	0.00217414	0.01916456	-0.00819653	-0.01975787	-0.00124884	0.00964528	-0.02812678	-0.0397808	-0.03343666	-0.01351249	0.02183294	0.01890063	0.00138974	-0.02871609	-0.07698476	0.01258427	0.01904273	0.00137579	0.02645415
0.05793047	-0.01085091	-0.01089567	0.01373857	-0.00595546	0.04208946	-0.0103879	0.09829319	0.01418221	-0.00900406	-0.01624173	0.01161104	0.00449169	-0.04279387	-0.0124225	0.02694905	0.01612806	0.02459925	0.04965609	0.03210449	-0.00261056	-0.03556168	0.03007686	0.00156933	0.00202751	-0.01860857	-0.03988713	0.01755875
0.05318367	-0.00843179	0.01339358	0.00298566	0.02793437	0.04218769	0.02711606	-0.02715701	0.1433903	-0.01736778	0.03216231	-0.00814891	0.01482868	-0.02154821	-0.00623947	-0.00985777	0.00121063	-0.00605321	0.00776541	0.00253844	0.00305164	0.00395393	-0.00998819	-0.00883245	0.05696887	0.00591654	0.02595097	0.01277405
0.00559878	0.02440131	-0.01085532	-0.03354323	0.02075624	0.01874357	-0.01211029	-0.01815492	-0.00059772	0.10807115	0.01677793	0.00456947	0.00141907	-0.01640254	0.02437556	0.00276548	-0.00812942	0.02589786	0.03929609	0.01065683	-0.00057787	0.01981753	0.03158796	-0.03557223	0.01155412	0.0061211	0.00492162	0.00931948
0.01080072	-0.00055099	0.02955115	0.00176704	-0.02917284	0.02099425	0.03812963	0.01167303	-0.00605261	-0.01037365	0.11784208	0.01422912	-0.01384759	0.01173264	0.03708708	0.00485671	0.01972848	-0.00998688	0.00843138	0.00992751	0.03039795	0.01282281	-0.00949228	-0.02820575	0.04798579	0.01559353	-0.00691378	0.00557727
0.01894951	-0.02476543	0.00498211	-0.0223316	-0.00602329	-0.00867128	0.01087725	0.04803854	0.03111327	0.00393814	0.00995952	0.09954107	-0.0029698	-0.01873881	-0.03297561	0.00787884	0.02147388	0.01464933	0.0393548	0.03025126	-0.03205991	-0.01921725	0.01789504	-0.03207576	0.005162	0.00621152	0.02545029	0.00864899
-0.00258595	-0.01540196	0.00118649	0.01572037	-0.01120669	0.05297154	-0.04945159	0.03130329	-0.00228989	0.00047904	-0.00644112	0.03644031	0.08357722	-0.04606062	-0.01445639	0.01717377	0.00091797	0.02134311	0.0605076	0.0281924	-0.0121069	0.00679988	0.0265246	-0.10478193	-0.02430904	-0.00881535	0.0184043	0.00630808
-0.01676834	-0.07202661	0.01472706	-0.02072489	-0.04579252	-0.02377456	0.00987643	-0.03760827	-0.01955456	-0.00421315	0.01873952	-0.0149408	-0.02575344	0.18959355	0.07812196	-0.0186041	-0.01168221	-0.02912372	-0.06211025	0.02519011	-0.00067943	-0.04577315	-0.02833796	0.02094066	0.03433782	-0.03978121	-0.00433642	0.04947859
0.04719472	-0.03221536	-0.0143863	0.01517856	0.01793915	-0.00332302	-0.00903046	-0.02794129	0.0003587	-0.02057421	0.02802432	0.02469712	-0.02196187	0.07727569	0.18140221	0.00715739	-0.03992718	-0.00737476	-0.04344779	0.03250295	-0.00534028	-0.03150052	0.03035057	0.0449509	0.05891263	0.01676238	0.02925408	0.05784434
0.01565582	-0.04561806	-0.01503938	0.00502247	0.00025791	0.02703559	-0.00605011	0.03957891	0.01341659	0.02622008	0.00336146	0.01567245	-0.00054878	-0.03103179	-0.04115552	0.15403563	0.02513641	0.02412337	0.01231927	-0.00106698	-0.01947045	0.01955634	0.04503953	-0.04571044	0.02707189	0.00018978	0.0028066	0.0027982
0.02893454	-0.03798801	0.00217205	-0.03483558	-0.0223645	0.0288524	-0.02973491	-0.01846707	-0.0067544	0.01004291	0.0249247	0.01587057	0.0274356	-0.02798963	-0.00778198	0.00556028	0.07223564	-0.01162583	-0.01810503	0.04529554	0.03575259	0.00435418	-0.01816112	-0.05638736	0.05268127	0.0445925	-0.04407805	-0.02502334
0.03465265	0.01209432	-0.02626026	-0.00911319	0.00794381	0.05782157	0.00465024	0.01585716	0.025258	-0.0090248	0.02782381	0.0259282	0.01440132	-0.0124678	0.00523043	0.03077132	0.01167142	0.07622087	0.02571356	0.02678633	0.06012952	0.01044661	-0.01796889	-0.01280761	0.01772797	0.04192758	-0.0217998	-0.00721729
0.01361841	-0.03569418	0.00360101	-0.00874156	0.02253211	0.01816678	0.0035367	0.04497004	-0.00420892	0.01502907	0.00414973	0.02477771	0.01708221	-0.05843681	-0.00477827	-0.01878202	-0.00402892	-0.00285465	0.08563441	-0.0275563	-0.00793225	-0.0203346	0.00990081	-0.01744324	0.00916672	-0.00639272	0.01410002	0.00612795
0.03286177	0.04440272	0.04381019	0.01267731	-0.01615965	-0.02696735	-0.02420807	-0.02093619	-0.00807464	0.0124101	0.00373268	0.0440374	0.01644951	-0.03098774	0.01065421	0.0034889	-0.01365882	-0.00194603	-0.00584716	0.07654172	0.00601459	0.01226431	0.01143378	-0.04184687	0.01256967	0.05768311	0.02721381	0.02003312
0.02004856	-0.01123255	0.0479002	-0.01642865	0.03221995	-0.01223993	-0.02402288	0.01523387	-0.00138003	0.02583843	0.01216161	0.01236027	-0.01197088	-0.00242305	-0.01394063	0.01087117	0.02309114	-0.00276762	0.03685355	0.00457722	0.04669487	-0.02012897	0.00302321	-0.0136658	0.00912243	0.02556044	-0.0074991	-0.00871128
-0.01254499	0.03004795	0.05992228	0.05199981	0.00619477	0.04434848	-0.03028357	0.03129452	0.01968265	0.05717331	-0.02713662	0.03023213	-0.00757307	-0.04753864	-0.00366712	-0.0049668	-0.02193367	-0.0127722	-0.01132143	-0.00217241	0.02722549	0.06533951	0.00214803	0.00041258	0.01317286	0.01220375	0.02255583	0.02224284
-0.00295717	-0.00474501	0.00292391	0.00298893	-0.00376976	0.01156867	-0.02557033	0.02609134	-0.00897509	0.03579921	-0.03313565	0.01943624	0.06747609	-0.04138708	0.02327055	-0.00037193	0.01851535	-0.00170934	0.01405454	0.01327062	0.03337908	0.03220749	0.12102169	-0.034123	-0.00831765	0.01689363	-0.01033163	0.0141452
0.04776847	0.02252549	0.00653547	0.03121901	-0.00225878	-0.0165875	0.00239545	0.02366602	0.00565231	-0.030734	0.00378561	-0.05472827	-0.03184938	0.03942436	0.01095867	-0.02157027	-0.00987834	-0.02220809	0.04046822	0.00960988	0.00950122	-0.01478553	-0.01937234	0.21052533	-0.0011524	0.04870743	0.03427345	-0.02447784
0.00124794	0.00690103	0.01122838	0.00990599	-0.01131696	-0.02209067	-0.00755614	-0.02909839	-0.01487708	-0.03882653	0.01049125	0.03464103	0.00877106	0.04044092	0.0284968	0.03071696	0.01967901	-0.00394541	-0.03814685	0.02536929	0.04402721	0.00475806	-0.02122682	-0.03824401	0.1765818	0.02797949	-0.00179905	0.02258623
0.00800818	0.0102123	0.03003657	-0.00903249	0.03034979	0.00672615	-0.01782554	-0.04170108	0.00561154	-0.01223224	0.010427	-0.01922244	-0.00115114	-0.04182941	-0.02095622	-0.01771677	-0.02179933	0.00547099	0.00430518	0.01839411	0.01166421	0.01626933	0.01458389	-0.04857385	0.02707076	0.10691816	-0.01143169	0.00691432
0.00773901	-0.03794509	-0.00647527	-0.00591576	-0.02190417	0.02641892	0.00322825	0.0089457	0.01433939	-0.00867116	-0.01775062	0.02817595	-0.00038439	-0.00051415	0.01749665	0.0139969	-0.00114387	-0.01174366	0.01003534	0.02154028	0.01172686	0.00019902	-0.01638085	-0.02484804	-0.02383471	0.02920198	0.07500321	0.04373437
0.02809423	0.02941728	-0.0059514	-0.00950372	-0.00851506	-0.0193575	0.0211823	0.0237779	-0.00254297	-0.0027892	-0.0110451	-0.0106231	-0.00105417	0.04742563	0.01110047	0.01423144	0.0122323	-0.01661032	-0.01485139	0.0023064	0.00711054	-0.00031066	-0.01609784	-0.00213057	0.01249141	0.00818545	0.0081656	0.12349695
"""


matrix = m2o.strip().split("\n")
header = matrix[0].strip().split()
key_embedding = collections.defaultdict(list)

for line in matrix[1:]:
    line = line.strip().split()
    for lang, score in zip(header, line):
        key_embedding[lang].append(float(score))

Z = linkage(np.array(list(key_embedding.values())), 'average')
fig = plt.figure(figsize=(15, 10))
dn = dendrogram(Z, labels=np.array(list(key_embedding.keys())))
plt.show()

clusters = cut_tree(Z, n_clusters=7)
langs = list(key_embedding.keys())

language_clusters = collections.defaultdict(list)
for cls, lang in zip(clusters.T[0], langs):
    language_clusters[cls].append(lang)

for key, value in language_clusters.items():
    print(key, value)

